CREATE ASSEMBLY [FileExporter]
FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C01030078AF4B680000000000000000E00002210B010B00000A000000060000000000000E280000002000000040000000000010002000000002000004000000000000000400000000000000008000000002000000000000030040850000100000100000000010000010000000000000100000000000000000000000C02700004B00000000400000B802000000000000000000000000000000000000006000000C00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E746578740000001408000000200000000A000000020000000000000000000000000000200000602E72737263000000B80200000040000000040000000C0000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000001000000000000000000000000000004000004200000000000000000000000000000000F02700000000000048000000020005004C2100007406000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300300CA00000001000011000F00280400000A0A067201000070280500000A130511052D0C007221000070730600000A7A724900007006280700000A0B72BB000070730800000A0C00086F0900000A000708730A00000A0D00096F0B00000A72EB0000700F01280400000A6F0C00000A26096F0D00000A750100001B1304110414FE01130511052D13000F02280400000A1104280E00000A00002B0C0072FF000070730F00000A7A00DE120914FE01130511052D07096F1000000A00DC0000DE120814FE01130511052D07086F1000000A00DC002A0000011C000002004D0053A000120000000002003D0079B60012000000001E02281100000A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C000000D0010000237E00003C0200006C02000023537472696E677300000000A80400003001000023555300D8050000100000002347554944000000E80500008C00000023426C6F620000000000000002000001471502080900000000FA253300160000010000001100000002000000020000000300000011000000030000000100000001000000010000000300000000000A000100000000000600380031000A0060004B000600BC009C000600DC009C000A001501FA000E00540135010600620131000600740131000A00980182010A00B901A6010A00CB0182010A00D60182010A00FC0182010A001602A601060038022E0206004B0231000600550231000000000001000000000001000100010010001B00000005000100010050200000000096006A000A0001004421000000008618780014000400000001007E0000000200880000000300910019007800180021007800140029007800140011002B01220031005A012600390078002C0041007B013100490078002C005100C60114005900780037005900ED013E00610009024300710020024A0079003D025100810078002C0089006102140009007800140020001B001D002E000B0064002E0013006D0058004E000480000000000000000000000000000000001B000000040000000000000000000000010028000000000004000000000000000000000001003F0000000000040000000000000000000000010031000000000000000000003C4D6F64756C653E0046696C654578706F727465722E646C6C0046696C654578706F72746572006D73636F726C69620053797374656D004F626A6563740053797374656D2E446174610053797374656D2E446174612E53716C54797065730053716C537472696E6700705F54444543727444776E6C64002E63746F72007461626C654E616D650066696C654E616D65006F7574707574506174680053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300436F6D70696C6174696F6E52656C61786174696F6E734174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465004D6963726F736F66742E53716C5365727665722E5365727665720053716C50726F636564757265417474726962757465006765745F56616C75650053797374656D2E546578742E526567756C617245787072657373696F6E730052656765780049734D6174636800417267756D656E74457863657074696F6E00537472696E6700466F726D61740053797374656D2E446174612E53716C436C69656E740053716C436F6E6E656374696F6E0053797374656D2E446174612E436F6D6D6F6E004462436F6E6E656374696F6E004F70656E0053716C436F6D6D616E640053716C506172616D65746572436F6C6C656374696F6E006765745F506172616D65746572730053716C506172616D65746572004164645769746856616C7565004462436F6D6D616E6400457865637574655363616C61720053797374656D2E494F0046696C65005772697465416C6C427974657300457863657074696F6E0049446973706F7361626C6500446973706F736500000000001F5E005B0041002D005A0061002D007A0030002D0039005F005D002B002400012749006E00760061006C006900640020007400610062006C00650020006E0061006D0065002E000071530045004C004500430054002000460069006C00650043006F006E00740065006E0074002000460052004F004D0020005B007B0030007D005D002000570048004500520045002000460069006C0065004E0061006D00650020003D0020004000460069006C0065004E0061006D006500002F63006F006E007400650078007400200063006F006E006E0065006300740069006F006E003D00740072007500650000134000460069006C0065004E0061006D006500002F4E006F0020006D00610074006300680069006E0067002000660069006C006500200066006F0075006E0064002E000000EFDCE08EC444744AAAA48982361F27820008B77A5C561934E0890900030111091109110903200001042001010804010000000320000E050002020E0E042001010E0500020E0E1C062002010E1225042000123106200212350E1C0320001C021D05060002010E1D050B07060E0E1225122D1D05020801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F777301E82700000000000000000000FE270000002000000000000000000000000000000000000000000000F02700000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF2500200010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001001000000018000080000000000000000000000000000001000100000030000080000000000000000000000000000001000000000048000000584000005C02000000000000000000005C0234000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000000000000000000000000000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004BC010000010053007400720069006E006700460069006C00650049006E0066006F0000009801000001003000300030003000300034006200300000002C0002000100460069006C0065004400650073006300720069007000740069006F006E000000000020000000300008000100460069006C006500560065007200730069006F006E000000000030002E0030002E0030002E003000000044001100010049006E007400650072006E0061006C004E0061006D0065000000460069006C0065004500780070006F0072007400650072002E0064006C006C00000000002800020001004C006500670061006C0043006F0070007900720069006700680074000000200000004C00110001004F0072006900670069006E0061006C00460069006C0065006E0061006D0065000000460069006C0065004500780070006F0072007400650072002E0064006C006C0000000000340008000100500072006F006400750063007400560065007200730069006F006E00000030002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000030002E0030002E0030002E00300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000C000000103800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
WITH PERMISSION_SET = UNSAFE
GO


-- trust the assembly 
SELECT
HASHBYTES('SHA2_512', af.content) AS AssemblyHash
FROM sys.assemblies a
JOIN sys.assembly_files af
ON a.assembly_id = af.assembly_id
WHERE a.name = 'fileexporter'
AND af.name LIKE '%.dll';

EXEC sys.sp_add_trusted_assembly
@hash = 0x<PASTE_HASH_HERE>,
@description = N'fileexporter CLR assembly';